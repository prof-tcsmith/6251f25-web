<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 4 Assignment: ML Fundamentals & Linear Regression</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 20px;
        }
        .info-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .rubric-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .rubric-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
        }
        .rubric-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        .rubric-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .submission-box {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
        }
        .concept-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Week 4 Assignment: ML Fundamentals & Linear Regression</h1>
        
        <div class="info-box">
            <h3 style="margin-top: 0; color: white;">Assignment Overview</h3>
            <p><strong>Due Date:</strong> End of Week 4 (Sunday 11:59 PM)</p>
            <p><strong>Total Points:</strong> 20</p>
            <p><strong>Learning Objectives:</strong> Demonstrate understanding of overfitting/underfitting, implement proper train/validation/test splits, build and evaluate linear regression models, and interpret results.</p>
        </div>

        <h2>Business Context</h2>
        <p>You're a data scientist at a real estate company tasked with building a model to predict house prices. You need to ensure your model generalizes well to new properties and doesn't overfit to historical data. Management wants a transparent model they can understand and trust.</p>

        <div class="concept-box">
            <h4>Dataset: Housing Price Prediction</h4>
            <p>Features include:</p>
            <ul>
                <li><code>sqft</code>: Square footage of the house</li>
                <li><code>bedrooms</code>: Number of bedrooms</li>
                <li><code>bathrooms</code>: Number of bathrooms</li>
                <li><code>age</code>: Age of the house in years</li>
                <li><code>garage</code>: Number of garage spaces</li>
                <li><code>neighborhood</code>: Categorical (A, B, C, D)</li>
                <li><code>has_pool</code>: Binary (0 or 1)</li>
                <li><code>price</code>: Target variable (in thousands)</li>
            </ul>
        </div>

        <h2>Part 1: ML Fundamentals - Overfitting & Data Splits (5 points)</h2>
        
        <h3>Task 1.1: Understanding Overfitting (2 points)</h3>
        <ol type="a">
            <li>Create polynomial features of degrees 1, 3, 5, and 10 for the <code>sqft</code> variable</li>
            <li>Train a model for each polynomial degree using ONLY a training set</li>
            <li>Plot the fitted curves and training data</li>
            <li>Explain which models appear to be underfitting, just right, or overfitting and why</li>
        </ol>

        <h3>Task 1.2: Proper Train/Validation/Test Split (3 points)</h3>
        <ol type="a">
            <li>Split your data into:
                <ul>
                    <li>60% training</li>
                    <li>20% validation</li>
                    <li>20% test (hold out completely)</li>
                </ul>
            </li>
            <li>Train the polynomial models (degrees 1, 3, 5, 10) on training data</li>
            <li>Evaluate on validation set and select the best model</li>
            <li>Explain why we need validation set separate from test set (data leakage concept)</li>
            <li>Report final performance on test set for selected model only</li>
        </ol>

        <h2>Part 2: Linear Regression Implementation (5 points)</h2>
        
        <h3>Task 2.1: Data Preparation & Simple Linear Regression (2.5 points)</h3>
        <ol type="a">
            <li>Prepare the full feature set:
                <ul>
                    <li>One-hot encode <code>neighborhood</code> (remember drop_first=True)</li>
                    <li>Scale continuous features using StandardScaler</li>
                    <li>Fit preprocessing on training data only</li>
                </ul>
            </li>
            <li>Implement simple linear regression using just <code>sqft</code>:
                <ul>
                    <li>Train the model</li>
                    <li>Create a scatter plot with regression line</li>
                    <li>Calculate and interpret the coefficient</li>
                </ul>
            </li>
        </ol>

        <h3>Task 2.2: Multiple Linear Regression (2.5 points)</h3>
        <ol type="a">
            <li>Train a multiple linear regression with all features</li>
            <li>Report and interpret:
                <ul>
                    <li>Top 3 most important features (by coefficient magnitude)</li>
                    <li>R² on training and validation sets</li>
                    <li>RMSE on training and validation sets</li>
                </ul>
            </li>
            <li>Check for overfitting by comparing train vs validation metrics</li>
        </ol>

        <h2>Part 3: Model Evaluation & Diagnostics (5 points)</h2>
        
        <h3>Task 3.1: Residual Analysis (3 points)</h3>
        <ol type="a">
            <li>Create a residual plot (residuals vs fitted values)</li>
            <li>Check for:
                <ul>
                    <li>Homoscedasticity (constant variance)</li>
                    <li>Linearity (random scatter around zero)</li>
                    <li>Outliers (points far from others)</li>
                </ul>
            </li>
            <li>Create a histogram of residuals to check normality</li>
            <li>Interpret what these plots tell you about model assumptions</li>
        </ol>

        <h3>Task 3.2: Cross-Validation (2 points)</h3>
        <ol type="a">
            <li>Implement 5-fold cross-validation on the training+validation data</li>
            <li>Report mean and standard deviation of R² across folds</li>
            <li>Compare to single train/validation split results</li>
            <li>Explain why cross-validation gives more robust estimates</li>
        </ol>

        <h2>Part 4: Regularization & Final Model (5 points)</h2>
        
        <h3>Task 4.1: Ridge Regression (2.5 points)</h3>
        <ol type="a">
            <li>Implement Ridge regression with alpha values: [0.01, 0.1, 1, 10, 100]</li>
            <li>Use validation set to select best alpha</li>
            <li>Compare coefficients between regular linear regression and best Ridge model</li>
            <li>Explain how Ridge affects the coefficients</li>
        </ol>

        <h3>Task 4.2: Final Model & Business Insights (2.5 points)</h3>
        <ol type="a">
            <li>Select your final model (regular or Ridge) based on validation performance</li>
            <li>Evaluate ONLY ONCE on the test set (report R² and RMSE)</li>
            <li>Provide business insights:
                <ul>
                    <li>Which features most impact house prices?</li>
                    <li>How much does each additional bedroom add to price?</li>
                    <li>What's the premium for neighborhood A vs neighborhood D?</li>
                </ul>
            </li>
            <li>Discuss model limitations and potential improvements</li>
        </ol>

        <div class="submission-box">
            <h3 style="margin-top: 0;">Submission Requirements</h3>
            <p>Submit a Jupyter Notebook named <code>week04_[YourStudentID].ipynb</code> containing:</p>
            <ol>
                <li>All code cells with outputs displayed</li>
                <li>Markdown cells explaining your approach and findings</li>
                <li>All required visualizations</li>
                <li>A summary section with:
                    <ul>
                        <li>Final model choice and justification</li>
                        <li>Test set performance (R² and RMSE)</li>
                        <li>Key business insights</li>
                        <li>Lessons learned about overfitting and proper evaluation</li>
                    </ul>
                </li>
            </ol>
        </div>

        <h2>Grading Rubric (20 Points Total)</h2>
        
        <table class="rubric-table">
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Points</th>
                    <th>Excellent (100%)</th>
                    <th>Good (80%)</th>
                    <th>Satisfactory (60%)</th>
                    <th>Needs Improvement (40%)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ML Fundamentals</strong><br>(Overfitting, splits)</td>
                    <td>5</td>
                    <td>Clear demonstration of concepts, proper train/val/test split, no data leakage</td>
                    <td>Good understanding, minor issues with implementation</td>
                    <td>Basic concepts shown, some confusion on splits</td>
                    <td>Major misunderstandings or incorrect implementation</td>
                </tr>
                <tr>
                    <td><strong>Linear Regression</strong><br>(Implementation)</td>
                    <td>5</td>
                    <td>Correct implementation, proper preprocessing, clear interpretation</td>
                    <td>Mostly correct, minor preprocessing issues</td>
                    <td>Basic regression works, some errors</td>
                    <td>Significant implementation problems</td>
                </tr>
                <tr>
                    <td><strong>Model Evaluation</strong><br>(Diagnostics, CV)</td>
                    <td>5</td>
                    <td>Comprehensive residual analysis, correct CV implementation, insightful interpretation</td>
                    <td>Good diagnostics, CV works, decent interpretation</td>
                    <td>Basic plots created, simple CV attempted</td>
                    <td>Poor or missing diagnostics</td>
                </tr>
                <tr>
                    <td><strong>Regularization & Insights</strong><br>(Ridge, business value)</td>
                    <td>5</td>
                    <td>Excellent Ridge implementation, clear business insights, proper model selection</td>
                    <td>Good regularization, reasonable insights</td>
                    <td>Basic Ridge attempted, limited insights</td>
                    <td>Poor implementation or missing insights</td>
                </tr>
            </tbody>
        </table>

        <div class="warning-box">
            <h4 style="margin-top: 0;">Critical Requirements:</h4>
            <ul>
                <li><strong>Sacred Test Set:</strong> Only evaluate on test set ONCE with your final model</li>
                <li><strong>No Data Leakage:</strong> Fit all preprocessing on training data only</li>
                <li><strong>Proper Workflow:</strong> Train → Validate → Select → Test (in that order)</li>
                <li><strong>Interpretation:</strong> Don't just report numbers, explain what they mean</li>
            </ul>
        </div>

        <h2>Starter Code</h2>
        <pre><code class="python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split, cross_val_score, KFold
from sklearn.linear_model import LinearRegression, Ridge
from sklearn.preprocessing import StandardScaler, PolynomialFeatures
from sklearn.metrics import r2_score, mean_squared_error
import warnings
warnings.filterwarnings('ignore')

# Generate synthetic housing data
np.random.seed(42)
n_samples = 1000

# Create features
sqft = np.random.normal(1500, 500, n_samples)
sqft = np.clip(sqft, 500, 4000)  # Realistic range
bedrooms = np.random.poisson(3, n_samples) + 1
bathrooms = np.random.poisson(2, n_samples) + 1
age = np.random.uniform(0, 50, n_samples)
garage = np.random.choice([0, 1, 2, 3], n_samples, p=[0.2, 0.4, 0.3, 0.1])
neighborhood = np.random.choice(['A', 'B', 'C', 'D'], n_samples, p=[0.15, 0.35, 0.35, 0.15])
has_pool = np.random.choice([0, 1], n_samples, p=[0.7, 0.3])

# Create price with some realistic relationships
price = (
    100 +  # Base price
    0.15 * sqft +  # Price per sqft
    20 * bedrooms +  # Premium per bedroom
    15 * bathrooms +  # Premium per bathroom
    -1.5 * age +  # Depreciation
    10 * garage +  # Garage premium
    30 * (neighborhood == 'A').astype(int) +  # Neighborhood A premium
    -20 * (neighborhood == 'D').astype(int) +  # Neighborhood D discount
    25 * has_pool +  # Pool premium
    np.random.normal(0, 30, n_samples)  # Noise
)

# Create DataFrame
df = pd.DataFrame({
    'sqft': sqft,
    'bedrooms': bedrooms,
    'bathrooms': bathrooms,
    'age': age,
    'garage': garage,
    'neighborhood': neighborhood,
    'has_pool': has_pool,
    'price': price
})

print("Dataset shape:", df.shape)
print("\nFirst few rows:")
print(df.head())
print("\nBasic statistics:")
print(df.describe())

# Part 1.1: Polynomial Features Example
X_sqft = df[['sqft']].values
y = df['price'].values

# Create polynomial features
poly_features = {}
for degree in [1, 3, 5, 10]:
    poly = PolynomialFeatures(degree)
    poly_features[degree] = poly.fit_transform(X_sqft)
    print(f"Polynomial degree {degree}: {poly_features[degree].shape[1]} features")

# Your implementation starts here...</code></pre>

        <h2>Tips for Success</h2>
        <ul>
            <li><strong>Part 1:</strong> Visualize the polynomial fits to clearly show overfitting</li>
            <li><strong>Part 2:</strong> Remember to scale features before linear regression</li>
            <li><strong>Part 3:</strong> Look for patterns in residual plots, not just randomness</li>
            <li><strong>Part 4:</strong> Try plotting Ridge coefficients vs alpha to see shrinkage</li>
            <li><strong>General:</strong> Use the sacred test set rule - touch it only once!</li>
            <li>Reference the "learning/practice exams/final exam" analogy from lectures</li>
        </ul>
    </div>
</body>
</html>